#data input script
#reads climate data, truncates to 101 years, and imputes missing values
#clear all variables
rm(list=ls())
#libraries
library(timeDate)
library(Amelia)
library(parallel)
library(ggplot2)
library(plyr)
# Set working directory ---------------------------------------------------
if(Sys.getenv("USERNAME")=="Collin" || Sys.getenv("USERNAME")=="collin"){ #If it's collin
if(Sys.info()[1]=="Linux"){
setwd("/home/collin/Dropbox/Grad school/research projects/yang_cue")
}else{
setwd("C:\\Repos\\phenology-cues") #desktop
}
}else{
if(Sys.getenv("COMPUTERNAME")=="ENT-YANG01"){
setwd("C:\\Users\\louie\\Documents\\GitHub\\phenology-cues")#desktop
}else{
setwd("C:\\Users\\louie\\Documents\\GitHub\\phenology-cues")} #SP4
}
# input data --------------------------------------------------------------
start.date<-as.Date("1941-01-01") #the dataset will start on 1914-01-01 for Ithaca and Davis, but other data are shorter
start.year<-as.numeric(format(start.date,'%Y'))
end.date<-as.Date("2014-12-31") #the dataset will end on 2014-12-31
end.year<-as.numeric(format(end.date,'%Y'))
complete.dates<-data.frame(seq(start.date,end.date,1)) #all dates between the start and end dates
colnames(complete.dates)<-c("COMPLETE.DATES") #renaming the column
#See http://fivethirtyeight.com/features/which-city-has-the-most-unpredictable-weather/
#daily<-read.csv("climate data/davis-data/626713.csv", header=T, na.strings="-9999")  #Go Aggies!
#daily<-read.csv("climate data/ithaca-data/627453.csv", header=T, na.strings="-9999") #Go Big Red!
#daily<-read.csv("climate data/great falls-data/795486.csv", header=T, na.strings="-9999") #least predictable temp, starts April 1937
#daily<-read.csv("climate data/rapid city-data/795493.csv", header=T, na.strings="-9999") #least predicable overall, starts May 1948
daily<-read.csv("climate data/honolulu-data/795286.csv", header=T, na.strings="-9999")  #most predicable in temp and overall, starts May 1940
daily$DATE2<-as.Date(as.character(daily$DATE),format="%Y %m %d") #DATE2 is date formatted
daily<-merge(daily,complete.dates,by.x="DATE2",by.y="COMPLETE.DATES",all.y=TRUE) #add missing rows
daily$YEAR<-as.numeric(format(daily$DATE2,"%Y")) #simple field for year
daily$MONTH<-as.numeric(format(daily$DATE2,"%m")) #simple field for month
daily$DAY<-as.numeric(format(daily$DATE2,"%d")) #simple field for day
daily$DAY.OF.YEAR<-as.POSIXlt(daily$DATE2)$yday+1 #day of the year
daily$JULIAN<-julian(daily$DATE2,origin=start.date-1) #1914-01-01 is day 1
daily<-daily[daily$YEAR>start.year-1 & daily$YEAR<end.year+1,] #truncates the data to available years
daily$PRCP<-daily$PRCP/10 #precips are reported in tenths of mm, units changed to mm
daily$TMAX<-daily$TMAX/10 #temps are reported in tenths of degree C, units changed to degree C
daily$TMIN<-daily$TMIN/10 #temps are reported in tenths of degree C, units changed to degree C
daily<-daily[,c("DATE2","JULIAN","YEAR","MONTH","DAY","DAY.OF.YEAR","PRCP","TMAX","TMIN")] #simplified dataframe
daily.means<-aggregate(cbind(TMAX,TMIN,PRCP)~DAY.OF.YEAR, data=daily, mean)
colnames(daily.means)<-c("DAY.OF.YEAR","TMAX.means","TMIN.means","PRCP.means")
daily.sd<-aggregate(cbind(TMAX,TMIN,PRCP)~DAY.OF.YEAR, data=daily, sd)
colnames(daily.sd)<-c("DAY.OF.YEAR","TMAX.sd","TMIN.sd","PRCP.sd")
head(daily.means)
plot(daily.means$DAY.OF.YEAR,daily.means$PRCP.means)
