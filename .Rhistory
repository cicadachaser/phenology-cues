points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
points(1:day, pred.y,col='blue',type="l")
smooth.parm=.3 #smoothing parameter
##Quick test of smooth.spline
# dat=sin((1:day)/pi)*5+runif(day)*3
# temp.spl=smooth.spline(x=dat,spar=smooth.parm,all.knots=TRUE)
# temp.pred=predict(temp.spl,x=(1:day))
# plot(dat)
# points(temp.pred,type='l',col='blue')
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
temp.pred=predict(temp.spl,x=1:day, deriv=0)
pred.y=temp.pred$y
plot(year.cur$temp[1:(day+10)],type="n",
xlab="Day",
ylab="Temperature",
main=paste("Spline fit, smoothing parm of",smooth.parm))
points(1:day,year.cur$temp[1:(day)],pch=19)
points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
points(1:day, pred.y,col='blue',type="l")
smooth.parm=.5 #smoothing parameter
##Quick test of smooth.spline
# dat=sin((1:day)/pi)*5+runif(day)*3
# temp.spl=smooth.spline(x=dat,spar=smooth.parm,all.knots=TRUE)
# temp.pred=predict(temp.spl,x=(1:day))
# plot(dat)
# points(temp.pred,type='l',col='blue')
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
temp.pred=predict(temp.spl,x=1:day, deriv=0)
pred.y=temp.pred$y
plot(year.cur$temp[1:(day+10)],type="n",
xlab="Day",
ylab="Temperature",
main=paste("Spline fit, smoothing parm of",smooth.parm))
points(1:day,year.cur$temp[1:(day)],pch=19)
points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
points(1:day, pred.y,col='blue',type="l")
smooth.parm=.6 #smoothing parameter
##Quick test of smooth.spline
# dat=sin((1:day)/pi)*5+runif(day)*3
# temp.spl=smooth.spline(x=dat,spar=smooth.parm,all.knots=TRUE)
# temp.pred=predict(temp.spl,x=(1:day))
# plot(dat)
# points(temp.pred,type='l',col='blue')
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
temp.pred=predict(temp.spl,x=1:day, deriv=0)
pred.y=temp.pred$y
plot(year.cur$temp[1:(day+10)],type="n",
xlab="Day",
ylab="Temperature",
main=paste("Spline fit, smoothing parm of",smooth.parm))
points(1:day,year.cur$temp[1:(day)],pch=19)
points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
points(1:day, pred.y,col='blue',type="l")
temp.spl
temp.spl$df
smooth.parm=smooth.default #smoothing parameter
temp.ls=loess(temp~day,span=smooth.parm,data=year.cur[1:day,])
temp.pred=predict(temp.ls,x=year.cur[1:day,"temp"])
pred.y=temp.pred
plot(year.cur$temp[1:(day+10)],type="n",
xlab="Day",
ylab="Temperature",
main=paste("LOESS fit, smoothing parm of",smooth.parm))
points(1:day,year.cur$temp[1:(day)],pch=19)
points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
points(1:day, pred.y,col='blue',type="l")
#Reading in parameters, setting things up
i.year=1 #year to check
day=80 #"current" day
smooth.default=.5
#Load in year
years.list=yeargen("davisDat.Rdata",fit.parms=fit.parms)[[1]] #this uses the fitness parameters and fitness function listed above
year.cur=years.list[[1]]
require(stats)
##Quick test of smooth.spline
# dat=sin((1:day)/pi)*5+runif(day)*3
# temp.spl=smooth.spline(x=dat,spar=smooth.parm,all.knots=TRUE)
# temp.pred=predict(temp.spl,x=(1:day))
# plot(dat)
# points(temp.pred,type='l',col='blue')
smooth.parm=smooth.default
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
temp.pred=predict(temp.spl,x=1:day, deriv=0)
pred.y=temp.pred$y
plot(year.cur$temp[1:(day+10)],type="n",
xlab="Day",
ylab="Temperature",
main=paste("Spline fit, smoothing parm of",smooth.parm))
points(1:day,year.cur$temp[1:(day)],pch=19)
points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
points(1:day, pred.y,col='blue',type="l")
smooth.parm=smooth.default #smoothing parameter
temp.ls=loess(temp~day,span=smooth.parm,data=year.cur[1:day,])
temp.pred=predict(temp.ls,x=year.cur[1:day,"temp"])
pred.y=temp.pred
plot(year.cur$temp[1:(day+10)],type="n",
xlab="Day",
ylab="Temperature",
main=paste("LOESS fit, smoothing parm of",smooth.parm))
points(1:day,year.cur$temp[1:(day)],pch=19)
points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
points(1:day, pred.y,col='blue',type="l")
temp.ls$df
names(temp.ls)
summary(temp.ls)
temp.ls$trace.hat
?text
?predict.smooth.spline
smooth.parm=.57
deriv.store=rep(0,365)
for(day in 3:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
derive.store[day]=predict(day,deriv=1)
}
plot(derive.store)
# plot(year.cur$temp[1:(day+10)],type="n",
#      xlab="Day",
#      ylab="Temperature",
#      main=paste("Spline fit, smoothing parm of",smooth.parm))
# points(1:day,year.cur$temp[1:(day)],pch=19)
# points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
# points(1:day, pred.y,col='blue',type="l")
# text(labels=paste("~df = ",temp.spl$df),x=1,y=25,cex=1,pos=4)
smooth.parm=.57
deriv.store=rep(0,365)
for(day in 3:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
derive.store[day]=predict(day,deriv=1)
}
smooth.parm=.57
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
derive.store[day]=predict(day,deriv=1)
}
plot(derive.store)
smooth.parm=.57
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(day,deriv=1)
}
plot(derive.store)
# plot(year.cur$temp[1:(day+10)],type="n",
#      xlab="Day",
#      ylab="Temperature",
#      main=paste("Spline fit, smoothing parm of",smooth.parm))
# points(1:day,year.cur$temp[1:(day)],pch=19)
# points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
# points(1:day, pred.y,col='blue',type="l")
# text(labels=paste("~df = ",temp.spl$df),x=1,y=25,cex=1,pos=4)
x11()
smooth.parm=.57
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(day,deriv=1)
}
plot(derive.store)
# plot(year.cur$temp[1:(day+10)],type="n",
#      xlab="Day",
#      ylab="Temperature",
#      main=paste("Spline fit, smoothing parm of",smooth.parm))
# points(1:day,year.cur$temp[1:(day)],pch=19)
# points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
# points(1:day, pred.y,col='blue',type="l")
# text(labels=paste("~df = ",temp.spl$df),x=1,y=25,cex=1,pos=4)
smooth.parm=.57
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)
}
plot(derive.store)
# plot(year.cur$temp[1:(day+10)],type="n",
#      xlab="Day",
#      ylab="Temperature",
#      main=paste("Spline fit, smoothing parm of",smooth.parm))
# points(1:day,year.cur$temp[1:(day)],pch=19)
# points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
# points(1:day, pred.y,col='blue',type="l")
# text(labels=paste("~df = ",temp.spl$df),x=1,y=25,cex=1,pos=4)
warnings()
predict(temp.spl,day,deriv=1)
smooth.parm=.57
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(derive.store)
# plot(year.cur$temp[1:(day+10)],type="n",
#      xlab="Day",
#      ylab="Temperature",
#      main=paste("Spline fit, smoothing parm of",smooth.parm))
# points(1:day,year.cur$temp[1:(day)],pch=19)
# points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
# points(1:day, pred.y,col='blue',type="l")
# text(labels=paste("~df = ",temp.spl$df),x=1,y=25,cex=1,pos=4)
smooth.parm=.57
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(deriv.store)
# plot(year.cur$temp[1:(day+10)],type="n",
#      xlab="Day",
#      ylab="Temperature",
#      main=paste("Spline fit, smoothing parm of",smooth.parm))
# points(1:day,year.cur$temp[1:(day)],pch=19)
# points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
# points(1:day, pred.y,col='blue',type="l")
# text(labels=paste("~df = ",temp.spl$df),x=1,y=25,cex=1,pos=4)
smooth.parm=.57
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
par(mfrow(c(1,2)))
plot(year.cur$temp,type='l', main="temperature")
plot(deriv.store,type='l',main="estimated dtemp")
# plot(year.cur$temp[1:(day+10)],type="n",
#      xlab="Day",
#      ylab="Temperature",
#      main=paste("Spline fit, smoothing parm of",smooth.parm))
# points(1:day,year.cur$temp[1:(day)],pch=19)
# points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
# points(1:day, pred.y,col='blue',type="l")
# text(labels=paste("~df = ",temp.spl$df),x=1,y=25,cex=1,pos=4)
smooth.parm=.57
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
par(mfrow=c(1,2))
plot(year.cur$temp,type='l', main="temperature")
plot(deriv.store,type='l',main="estimated dtemp")
# plot(year.cur$temp[1:(day+10)],type="n",
#      xlab="Day",
#      ylab="Temperature",
#      main=paste("Spline fit, smoothing parm of",smooth.parm))
# points(1:day,year.cur$temp[1:(day)],pch=19)
# points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
# points(1:day, pred.y,col='blue',type="l")
# text(labels=paste("~df = ",temp.spl$df),x=1,y=25,cex=1,pos=4)
smooth.parm=.7
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(year.cur$temp, main="temperature")
points(predict(temp.spl,x=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
temp.spl=smooth.spline(x=year.cur[1:365,"temp"],spar=smooth.parm,all.knots=TRUE)
smooth.parm=.95
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(year.cur$temp, main="temperature")
temp.spl=smooth.spline(x=year.cur[1:365,"temp"],spar=smooth.parm,all.knots=TRUE)
points(predict(temp.spl,x=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
smooth.parm=.99
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(year.cur$temp, main="temperature")
temp.spl=smooth.spline(x=year.cur[1:365,"temp"],spar=smooth.parm,all.knots=TRUE)
points(predict(temp.spl,x=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
smooth.parm=2
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(year.cur$temp, main="temperature")
temp.spl=smooth.spline(x=year.cur[1:365,"temp"],spar=smooth.parm,all.knots=TRUE)
points(predict(temp.spl,x=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
smooth.parm=1
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(year.cur$temp, main="temperature")
temp.spl=smooth.spline(x=year.cur[1:365,"temp"],spar=smooth.parm,all.knots=TRUE)
points(predict(temp.spl,x=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
#Reading in parameters, setting things up
i.year=2 #year to check
day=80 #"current" day
smooth.default=.5
#Load in year
years.list=yeargen("davisDat.Rdata",fit.parms=fit.parms)[[1]] #this uses the fitness parameters and fitness function listed above
year.cur=years.list[[1]]
require(stats)
##Quick test of smooth.spline
# dat=sin((1:day)/pi)*5+runif(day)*3
# temp.spl=smooth.spline(x=dat,spar=smooth.parm,all.knots=TRUE)
# temp.pred=predict(temp.spl,x=(1:day))
# plot(dat)
# points(temp.pred,type='l',col='blue')
smooth.parm=.57
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
temp.pred=predict(temp.spl,x=1:day, deriv=0)
pred.y=temp.pred$y
plot(year.cur$temp[1:(day+10)],type="n",
xlab="Day",
ylab="Temperature",
main=paste("Spline fit, smoothing parm of",smooth.parm))
points(1:day,year.cur$temp[1:(day)],pch=19)
points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
points(1:day, pred.y,col='blue',type="l")
text(labels=paste("~df = ",temp.spl$df),x=1,y=25,cex=1,pos=4)
smooth.parm=.2 #smoothing parameter
temp.ls=loess(temp~day,span=smooth.parm,data=year.cur[1:day,])
temp.pred=predict(temp.ls,x=year.cur[1:day,"temp"])
pred.y=temp.pred
plot(year.cur$temp[1:(day+10)],type="n",
xlab="Day",
ylab="Temperature",
main=paste("LOESS fit, smoothing parm of",smooth.parm))
points(1:day,year.cur$temp[1:(day)],pch=19)
points((day+1):(day+10),year.cur$temp[(day+1):(day+10)],col='red',pch=19)
points(1:day, pred.y,col='blue',type="l")
text(labels=paste("~df = ",temp.ls$trace.hat),x=1,y=25,cex=1,pos=4)
smooth.parm=1
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(year.cur$temp, main="temperature")
temp.spl=smooth.spline(x=year.cur[1:365,"temp"],spar=smooth.parm,all.knots=TRUE)
points(predict(temp.spl,x=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
#Reading in parameters, setting things up
i.year=2 #year to check
day=80 #"current" day
smooth.default=.5
#Load in year
years.list=yeargen("davisDat.Rdata",fit.parms=fit.parms)[[1]] #this uses the fitness parameters and fitness function listed above
year.cur=years.list[[1]]
require(stats)
smooth.parm=1
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(year.cur$temp, main="temperature")
temp.spl=smooth.spline(x=year.cur[1:365,"temp"],spar=smooth.parm,all.knots=TRUE)
points(predict(temp.spl,x=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
#Reading in parameters, setting things up
i.year=5 #year to check
day=80 #"current" day
smooth.default=.5
#Load in year
years.list=yeargen("davisDat.Rdata",fit.parms=fit.parms)[[1]] #this uses the fitness parameters and fitness function listed above
year.cur=years.list[[1]]
require(stats)
smooth.parm=1
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(year.cur$temp, main="temperature")
temp.spl=smooth.spline(x=year.cur[1:365,"temp"],spar=smooth.parm,all.knots=TRUE)
points(predict(temp.spl,x=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
#Reading in parameters, setting things up
i.year=5 #year to check
day=80 #"current" day
smooth.default=.5
#Load in year
years.list=yeargen("davisDat.Rdata",fit.parms=fit.parms)[[1]] #this uses the fitness parameters and fitness function listed above
year.cur=years.list[[i.year]]
require(stats)
smooth.parm=1
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(year.cur$temp, main="temperature")
temp.spl=smooth.spline(x=year.cur[1:365,"temp"],spar=smooth.parm,all.knots=TRUE)
points(predict(temp.spl,x=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
smooth.parm=1.5
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(year.cur$temp, main="temperature")
temp.spl=smooth.spline(x=year.cur[1:365,"temp"],spar=smooth.parm,all.knots=TRUE)
points(predict(temp.spl,x=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
smooth.parm=1.2
deriv.store=rep(0,365)
for(day in 4:365){
temp.spl=smooth.spline(x=year.cur[1:day,"temp"],spar=smooth.parm,all.knots=TRUE)
deriv.store[day]=predict(temp.spl,day,deriv=1)$y
}
plot(year.cur$temp, main="temperature")
temp.spl=smooth.spline(x=year.cur[1:365,"temp"],spar=smooth.parm,all.knots=TRUE)
points(predict(temp.spl,x=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
plot(predict(temp.spl,x=1:365,deriv=1),type='l',col='blue',lwd=2)
?predict.loess
?loess
?predict.loess
#First, let's check the degrees of freedom for reference:
temp.spl$df
smooth.parm=.8
deriv.store=rep(0,365)
for(day in 4:365){
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur[1:day,])
days=predict(temp.spl,newdata=c(day-1,day))
deriv.store[day]=diff(days)
}
plot(year.cur$temp, main="temperature")
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur)
points(predict(temp.spl,newdata=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
#First, let's check the degrees of freedom for reference:
temp.spl$df
smooth.parm=.8
deriv.store=rep(0,365)
for(day in 10:365){
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur[1:day,])
days=predict(temp.spl,newdata=c(day-1,day))
deriv.store[day]=diff(days)
}
plot(year.cur$temp, main="temperature")
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur)
points(predict(temp.spl,newdata=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
day=10
#First, let's check the degrees of freedom for reference:
temp.spl$df
smooth.parm=.8
deriv.store=rep(0,365)
for(day in 10:365){
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur[1:day,])
days=predict(temp.spl,newdata=c(day-1,day))
deriv.store[day]=diff(days)
}
plot(year.cur$temp, main="temperature")
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur)
points(predict(temp.spl,newdata=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
#First, let's check the degrees of freedom for reference:
temp.spl$df
smooth.parm=.8
deriv.store=rep(0,365)
for(day in 10:365){
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur[1:day,])
days=predict(temp.spl,newdata=c(day-1,day))
deriv.store[day]=diff(days)
}
plot(year.cur$temp, main="temperature")
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur)
points(predict(temp.spl,newdata=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur[1:day,])
day
days=predict(temp.spl,newdata=c(day-1,day))
deriv.store[day]=diff(days)
days
predict(temp.spl,newdata=c(day-1,day))
predict.loess
#First, let's check the degrees of freedom for reference:
temp.spl$df
smooth.parm=.8
deriv.store=rep(0,365)
for(day in 10:365){
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur[1:day,])
days=predict(temp.ls,newdata=c(day-1,day))
deriv.store[day]=diff(days)
}
plot(year.cur$temp, main="temperature")
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur)
points(predict(temp.ls,newdata=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
#First, let's check the degrees of freedom for reference:
temp.spl$df
smooth.parm=1
deriv.store=rep(0,365)
for(day in 10:365){
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur[1:day,])
days=predict(temp.ls,newdata=c(day-1,day))
deriv.store[day]=diff(days)
}
plot(year.cur$temp, main="temperature")
temp.ls=loess(temp~day, span=smooth.parm, data=year.cur)
temp.ls$trace.hat
points(predict(temp.ls,newdata=1:365),type='l',col='blue',lwd=2)
plot(deriv.store,type='l',main="estimated dtemp")
plot(deriv.store[75:365],type='l',main="estimated dtemp")
