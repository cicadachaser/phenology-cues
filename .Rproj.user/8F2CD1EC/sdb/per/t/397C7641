{
    "contents" : "#clear all variables\nrm(list=ls(all = TRUE))\ngraphics.off()\npardefault <- par(no.readonly = T)\n\n#setwd(\"C:\\\\Users\\\\lhyang\\\\Dropbox\\\\Milkweeds and Monarchs\\\\Monarch SIA\\\\2010-2011 Western Monarchs\\\\Combined CA Monarchs\") #laptop path\n\nsetwd(\"C:\\\\Users\\\\lhyang.ent-yang01\\\\Documents\\\\Dropbox\\\\Milkweeds and monarchs\\\\Monarch SIA\\\\2010-2011 Western Monarchs\\\\Combined CA Monarchs\") #desktop path\n\nstd.err<-function(x){sd(x)/sqrt(length(x))}\n\nlibrary(ggm)\nlibrary(MASS)\nlibrary(ggplot2)\nlibrary(gridExtra)\nlibrary(maps)\nlibrary(mapplots)\nlibrary(ellipse)\n\nd<-read.csv(\"Combined CA Monarchs SIA 2015-09-11.csv\", header=T)\n\n#remove the 2011 Ellwood samples from this analysis\n#the Ellwood 2011 samples were salvaged from a winter die-off event and are hard to interpret and compare\n  d<-d[!d$year==\"2011\",]\n\n  nrow(d[d$batch2==\"Ground\",]) #There are 15 samples that were collected from the ground rather than from sweep samples. I can't be sure that they are representative of the sites, so I think it is probably safer to remove them from the analysis.\n  aggregate(delD~batch2*site,data=d,mean)\n\n#remove all samples collected dead from the ground\n  d<-d[!d$batch2==\"Ground\",]\n\n#remove all samples that are Oe positive\n#  d<-d[!d$Oe.recheck==\"1\",]\n\n#summarize counts from each site by sex\n  with(d,tapply(sampleID,list(site,sex),length))\n\n#generate PC scores for PC.size and PC.shape\n  sizedata<-with(d,cbind(MLength, MWidth, MArea))\n  shapedata<-with(d,cbind(aspectratio,roundness))\n  \n  PCsize<-prcomp(sizedata, scale=T)\n  summary(PCsize)\n  PCshape<-prcomp(shapedata, scale=T)\n  summary(PCshape)\n  \n  d$PC.size<--PCsize$x[,1] #making these negative so that larger PC.size = larger wings\n  d$PC.shape<--PCshape$x[,1] #making these negative so that larger PC.shape = higher aspect ratio\n  \n  par(mfrow=c(1,2), cex=1)\n  with(d,plot(PC.size,MLength)) #check the interpretation of PC.size\n  with(d,plot(PC.shape,roundness)) #check the interpretation of PC.shape\n  par(pardefault)\n\n#calculate wing loading\n\nd$loading<-d$body.mass/(d$MArea*2)\nd$alt.loading<-d$body.mass.no.wings/(d$MArea*2)\n\n# exploratory aggregating ----------------------------------------------------\n\naggregate(PC.size~sex,data=d,FUN=function(x) c(mean=mean(x),se=std.err(x))) #males have larger wings\naggregate(MArea~sex,data=d,FUN=function(x) c(mean=mean(x),se=std.err(x))) #males have larger wing areas\naggregate(body.mass~sex,data=d,FUN=function(x) c(mean=mean(x),se=std.err(x))) #males have larger body sizes\naggregate(body.mass.no.wings~sex,data=d,FUN=function(x) c(mean=mean(x),se=std.err(x))) #males have larger body sizes\n\naggregate(PC.size~site,data=d,FUN=function(x) c(mean=mean(x),se=std.err(x))) #Ellwood had the largest wings\naggregate(MArea~site,data=d,FUN=function(x) c(mean=mean(x),se=std.err(x))) #Ellwood had the largest wing areas\naggregate(body.mass~site,data=d,FUN=function(x) c(mean=mean(x),se=std.err(x))) #Ellwood had the largest body sizes\naggregate(body.mass.no.wings~site,data=d,FUN=function(x) c(mean=mean(x),se=std.err(x))) #Ellwood had the largest body sizes\n\naggregate(loading~sex,data=d,FUN=function(x) c(mean=mean(x),se=std.err(x))) #Males had slightly higher loading\naggregate(loading~site,data=d,FUN=function(x) c(mean=mean(x),se=std.err(x))) #Moran had slightly higher loading\n\n# linear models -----------------------------------------------------------\n\nm1<-lm(loading~site+sex,data=d)\nm1.1<-lm(loading~site, data=d)\nm1.2<-lm(loading~sex, data=d)\nanova(m1,m1.1,test=\"F\") #no significant effect of sex on loading\nanova(m1,m1.2) #significant effect of site? p=0.03792\n#plot(m1) #excellent normality\n\nm2<-lm(PC.size~site+sex,data=d)\nm2.1<-lm(PC.size~site, data=d)\nm2.2<-lm(PC.size~sex, data=d)\nanova(m2,m2.1) #Males have significantly larger wings, p=0.01255\nanova(m2,m2.2) #no significant effect of site on wing size\n#plot(m2) #good normality\n\nm3<-lm(body.mass~site+sex,data=d)\nm3.1<-lm(body.mass~site, data=d)\nm3.2<-lm(body.mass~sex, data=d)\nanova(m3,m3.1) #Males have marginally larger body masses, p=0.06923\nanova(m3,m3.2) #significant effect of site on body mass p=0.04395\n#plot(m3) #excellent normality\n\nm4<-lm(MArea~site+sex,data=d)\nm4.1<-lm(MArea~site, data=d)\nm4.2<-lm(MArea~sex, data=d)\nanova(m4,m4.1) #Males have marginally larger wing areas, p=0.01403 *\nanova(m4,m4.2) #no significant effect of site on wings p=0.2451\n#plot(m4) #excellent normality\n\nm5<-lm(delD~site+sex,data=d)\nm5.1<-lm(delD~site, data=d)\nm5.2<-lm(delD~sex, data=d)\nanova(m5,m5.1) #NS effect of sex, p=0.2339\nanova(m5,m5.2) #NS effect of site, p=0.1381\n#plot(m5) #good normality\n\n#overall correlation analyses and figure in base graphics\n#these are partial correlations that attempt the hold the effects of sex and site constant\n#while hard to think about, this seems appropriate given the residual explanation in pg. 427 in Zar\n#try this using the alternate package ggm, as described here:\n#https://books.google.com/books?id=Q9GCAgAAQBAJ&pg=PA236&lpg=PA236&dq=pcor.test+multiple+variables&source=bl&ots=eOR9y35_MQ&sig=kHvdHQr67dz1JlDi1wn8gDuM4cw&hl=en&sa=X&ei=WTyWVK7IHYLwoATCkYKgDw&ved=0CE8Q6AEwCA#v=onepage&q=pcor.test%20multiple%20variables&f=false\n\nd$sex.num<-as.numeric(d$sex)\nd$site.num<-as.numeric(d$site)\n\n# overall correlations and figure -----------------------------------------\n\n  attach(d)  #supplemental figure, export as 9 x 6 pdf\n    par(mfrow=c(2,3),mar = c(3,3,4,2), oma=c(3,3,2,2),xpd=NA,cex=0.7)\n      plot(PC.size,delD,xlab=\"PC-size\",ylab=expression(paste(delta,\"D\"[m])),col=ifelse(sex==\"M\",\"#67a9cf\",\"#ef8a62\"),pch=16,ylim=c(-190,-40),xlim=c(-6,4)) #males are blue\n      title(main=list(\"a.\", par(adj=0)),line=1.5); par(adj=0.5)\n      size.delD.corr<-pcor(c(\"PC.size\",\"delD\",\"sex.num\",\"site.num\"),var(d));size.delD.corr \n      pcor.test(size.delD.corr,2,length(!is.na(d$PC.size)))# SIG NEG CORR between PC.size and delD, rho=-0.4220147, p=3.578564e-06, df=110, t=-4.882176\n      lines(ellipse(size.delD.corr[1],centre=c(mean(PC.size),mean(delD)),scale=c(sd(PC.size),sd(delD))))\n          \n      plot(PC.shape,delD,xlab=\"PC-shape\",ylab=expression(paste(delta,\"D\"[m])),col=ifelse(sex==\"M\",\"#67a9cf\",\"#ef8a62\"),pch=16,ylim=c(-190,-40),xlim=c(-4,6))\n      title(main=list(\"b.\", par(adj=0)),line=1.5); par(adj=0.5)          \n      shape.delD.corr<-pcor(c(\"PC.shape\",\"delD\",\"sex.num\",\"site.num\"),var(d));shape.delD.corr # NS, rho=0.08740252, p=0.3594783, df=110, t=0.9202069\n      pcor.test(shape.delD.corr,2,length(!is.na(d$PC.shape)))\n\n      #Is there an overall correlation between body mass and del-D? \n      plot(body.mass,delD,xlab=expression(paste(\"body mass (mg)\")),ylab=expression(paste(delta,\"D\"[m])),col=ifelse(sex==\"M\",\"#67a9cf\",\"#ef8a62\"),pch=16,ylim=c(-190,-40),xlim=c(150,400)) \n      title(main=list(\"c.\", par(adj=0)),line=1.5); par(adj=0.5)\n      body.mass.delD.corr<-pcor(c(\"body.mass\",\"delD\",\"sex.num\",\"site.num\"),var(d[!is.na(d$body.mass),]));body.mass.delD.corr \n      pcor.test(body.mass.delD.corr,2,length(!is.na(d$body.mass))) # rho=-0.2185363, p=0.02061952, df=110, t=-2.348801\n      lines(ellipse(body.mass.delD.corr,centre=c(mean(body.mass,na.rm=T),mean(delD)),scale=c(sd(body.mass,na.rm=T),sd(delD)),level=0.95))\n\n      #Is there an overall correlation between body mass (no wings) and del-D? \n      plot(body.mass.no.wings,delD,xlab=expression(paste(\"body mass (mg) without wings\")),ylab=expression(paste(delta,\"D\"[m])),col=ifelse(sex==\"M\",\"#67a9cf\",\"#ef8a62\"),pch=16,ylim=c(-190,-40),xlim=c(100,350)) \n      title(main=list(\"d.\", par(adj=0)),line=1.5); par(adj=0.5)\n      body.mass.no.wings.delD.corr<-pcor(c(\"body.mass.no.wings\",\"delD\",\"sex.num\",\"site.num\"),var(d[!is.na(d$body.mass.no.wings),]));body.mass.no.wings.delD.corr \n      pcor.test(body.mass.no.wings.delD.corr,2,length(!is.na(d$body.mass.no.wings))) #NS rho=-0.1524327, p=0.108606, df= 110, t=-1.617632\n\n      #Is there an overall correlation between loading and del-D? No\n      plot(loading,delD,xlab=expression(paste(\"wing loading (mg/cm\"^\"2\",\")\",sep=\"\")),ylab=expression(paste(delta,\"D\"[m])),col=ifelse(sex==\"M\",\"#67a9cf\",\"#ef8a62\"),pch=16,ylim=c(-190,-40),xlim=c(8,22)) \n      title(main=list(\"e.\", par(adj=0)),line=1.5); par(adj=0.5)\n      loading.delD.corr<-pcor(c(\"loading\",\"delD\",\"sex.num\",\"site.num\"),var(d[!is.na(d$loading),]));loading.delD.corr \n      pcor.test(loading.delD.corr,2,length(!is.na(d$loading))) #rho=-0.019495, p=0.8383375, df= 110, t=-0.2045041\n      #lines(ellipse(loading.delD.corr,centre=c(mean(loading,na.rm=T),mean(delD)),scale=c(sd(loading,na.rm=T),sd(delD)),level=0.95))\n\n      plot(body.mass,PC.size,xlab=\"body mass (mg)\",ylab=\"PC-size\",col=ifelse(sex==\"M\",\"#67a9cf\",\"#ef8a62\"),pch=16,xlim=c(150,400),ylim=c(-6,4))\n      title(main=list(\"f.\", par(adj=0)),line=1.5); par(adj=0.5)\n      mass.size.corr<-pcor(c(\"body.mass\",\"PC.size\",\"sex.num\",\"site.num\"),var(d));mass.size.corr # \n      pcor.test(mass.size.corr,2,length(!is.na(d$body.mass)))\n      lines(ellipse(mass.size.corr,centre=c(mean(body.mass,na.rm=T),mean(PC.size)),scale=c(sd(body.mass,na.rm=T),sd(PC.size)),level=0.95))\n    par(pardefault)\ndetach(d)\n\n\n# subset by site ----------------------------------------------------------\n\nattach(d)\n  ellwood09<-d[which(site==\"Ellwood\" & year==\"2009\"),]\n  moran<-d[which(site==\"Moran\"),]\n  pismo<-d[which(site==\"Pismo\"),]\n  lighthouse<-d[which(site==\"Lighthouse\"),]\ndetach(d)\n\n#calculate means and range\n\nmean(ellwood09$delD)\nmin(ellwood09$delD)\nmax(ellwood09$delD)\n\nmean(moran$delD)\nmin(moran$delD)\nmax(moran$delD)\n\nmean(pismo$delD)\nmin(pismo$delD)\nmax(pismo$delD)\n\nmean(lighthouse$delD)\nmin(lighthouse$delD)\nmax(lighthouse$delD)\n\n#Are these distributions different? Post-hoc comparison between N and S sites\nn.sites<-c(moran$delD,lighthouse$delD)\ns.sites<-c(pismo$delD,ellwood09$delD)\nks.test(n.sites,s.sites) #  Two-sample two-sided KS test, D = 0.2611, p-value = 0.03245\n\nplot(ecdf(n.sites),col=\"red\")\nplot(ecdf(s.sites),add=T, col=\"blue\")\n\n# density plots -----------------------------------------------------------\n\n  par(mfrow=c(2,2), mar=c(2,2,4,2), oma=c(4,4,0,0)) # export PDF 9 x 6\n  \n    d0<-density(d$delD)\n    d1<-density(ellwood09$delD)\n    d2<-density(moran$delD)\n    d3<-density(pismo$delD)\n    d4<-density(lighthouse$delD)\n\n    plot(d4, xlim=c(-210,-25), ylim=c(0,0.025), yaxs=\"i\", main=\"\", xlab=\"\", col=\"cornflowerblue\") \n    points(lighthouse$delD,rep(0.022,length(lighthouse$delD)), pch=18, cex=1, col=adjustcolor(\"cornflowerblue\",alpha.f=0.5))\n    polygon(d4$x, d4$y, col=adjustcolor(\"cornflowerblue\",alpha.f=0.5), border=NA)\n    mtext(\"a. Lighthouse Field\", side=3, line=1, adj=-0.05, cex=0.8, font=2)\n    abline(v=-130,lty=\"dashed\")\n    abline(v=-115,lty=4)\n    abline(v=-100,lty=\"dotted\")\n    \n    plot(d2, xlim=c(-210,-25), ylim=c(0,0.025), yaxs=\"i\", main=\"\", xlab=\"\", col=\"forestgreen\") \n    points(moran$delD,rep(0.022,length(moran$delD)), pch=18, cex=1, col=adjustcolor(\"forestgreen\",alpha.f=0.5))\n    polygon(d2$x, d2$y, col=adjustcolor(\"forestgreen\",alpha.f=0.5), border=NA)\n    mtext(\"b. Moran Lake\", side=3, line=1, adj=-0.05, cex=0.8, font=2)\n    abline(v=-130,lty=\"dashed\")\n    abline(v=-115,lty=4)\n    abline(v=-100,lty=\"dotted\")\n    \n    plot(d3, xlim=c(-210,-25), ylim=c(0,0.025), yaxs=\"i\", main=\"\", xlab=\"\", col=\"darkgoldenrod1\")  \n    points(pismo$delD,rep(0.022,length(pismo$delD)), pch=18, cex=1, col=adjustcolor(\"darkgoldenrod1\",alpha.f=0.5))\n    polygon(d3$x, d3$y, col=adjustcolor(\"darkgoldenrod1\",alpha.f=0.5), border=NA)\n    mtext(\"c. Pismo Beach\", side=3, line=1, adj=-0.05, cex=0.8, font=2)\n    abline(v=-130,lty=\"dashed\")\n    abline(v=-115,lty=4)\n    abline(v=-100,lty=\"dotted\")\n    \n    plot(d1, xlim=c(-210,-25), ylim=c(0,0.025), yaxs=\"i\", main=\"\", xlab=\"\", col=\"orangered\")  \n    points(ellwood09$delD,rep(0.022,length(ellwood09$delD)), pch=18, cex=1, col=adjustcolor(\"orangered\",alpha.f=0.5))\n    polygon(d1$x, d1$y, col=adjustcolor(\"orangered\",alpha.f=0.5), border=NA)\n    mtext(\"d. Coronado Preserve\", side=3, line=1, adj=-0.05, cex=0.8, font=2)\n    abline(v=-130,lty=\"dashed\")\n    abline(v=-115,lty=4)\n    abline(v=-100,lty=\"dotted\")\n    \n    mtext(\"density\", side=2, outer=T, line=2)\n    mtext(expression(paste(delta,\"D\"[m])), side=1, outer=T, line=2)\n  \n  par(pardefault)\n\n# integrals ------------------------------------------------------\n# calculate integrals of density kernels to determine proproportinal contributions\n  \n  d0.fun <- approxfun(d0$x, d0$y, yleft = 0, yright = 0)\n  d1.fun <- approxfun(d1$x, d1$y, yleft = 0, yright = 0)\n  d2.fun <- approxfun(d2$x, d2$y, yleft = 0, yright = 0)\n  d3.fun <- approxfun(d3$x, d3$y, yleft = 0, yright = 0)\n  d4.fun <- approxfun(d4$x, d4$y, yleft = 0, yright = 0)  \n\n  overall.coast<-integrate(d0.fun,-100, Inf);overall.coast\n  overall.south<-integrate(d0.fun,-115, -100);overall.south \n  overall.central<-integrate(d0.fun,-130, -115);overall.central \n  overall.north<-integrate(d0.fun,-Inf, -130);overall.north \n\n  ellwood.coast<-integrate(d1.fun,-100, Inf);ellwood.coast\n  ellwood.south<-integrate(d1.fun,-115, -100);ellwood.south \n  ellwood.central<-integrate(d1.fun,-130, -115);ellwood.central \n  ellwood.north<-integrate(d1.fun,-Inf, -130);ellwood.north \n\n  moran.coast<-integrate(d2.fun,-100, Inf);moran.coast\n  moran.south<-integrate(d2.fun,-115, -100);moran.south \n  moran.central<-integrate(d2.fun,-130, -115);moran.central \n  moran.north<-integrate(d2.fun,-Inf, -130);moran.north \n\n  pismo.coast<-integrate(d3.fun,-100, Inf);pismo.coast \n  pismo.south<-integrate(d3.fun,-115, -100);pismo.south \n  pismo.central<-integrate(d3.fun,-130, -115);pismo.central \n  pismo.north<-integrate(d3.fun,-Inf, -130);pismo.north \n\n  lighthouse.coast<-integrate(d4.fun,-100, Inf);lighthouse.coast \n  lighthouse.south<-integrate(d4.fun,-115, -100);lighthouse.south \n  lighthouse.central<-integrate(d4.fun,-130, -115);lighthouse.central \n  lighthouse.north<-integrate(d4.fun,-Inf, -130);lighthouse.north \n\n\n# map with pie charts -----------------------------------------------------\n# export as PDF 12 x 12, combine with isoscape in AI\n\n  par(oma=c(5,4,0,0),xpd=T)\n    map(\"state\", region = \"california\",xlim=c(-128,-112),ylim=c(30,45))  \n    map.palette<-c(\"#225ea8\",\"#41b6c4\",\"#a1dab4\",\"#ffffcc\")\n    lines(x=c(-127,-119.890920),y=c(32,34.422495))    #Ellwood      34.422495?N -119.890920?W\n    add.pie(c(ellwood.coast$value,ellwood.south$value,ellwood.central$value,ellwood.north$value),-127, 32, col=map.palette, labels=NA, radius=.8,init.angle=90)\n    lines(x=c(-127,-120.632945),y=c(35,35.129145))     #Pismo        35.129145?N -120.632945?W\n    add.pie(c(pismo.coast$value,pismo.south$value,pismo.central$value,pismo.north$value),-127, 35, col=map.palette, labels=NA, radius=.8,init.angle=90)\n    lines(x=c(-127,-121.975568),y=c(38,36.958253))     #Moran        36.958253?N -121.975568?W\n    add.pie(c(moran.coast$value,moran.south$value,moran.central$value,moran.north$value),-127, 38, col=map.palette, labels=NA, radius=.8,init.angle=90)\n    lines(x=c(-127,-122.029920),y=c(41,36.953527))     #Lighthouse   36.953527?N -122.029920?W\n    add.pie(c(lighthouse.coast$value,lighthouse.south$value,lighthouse.central$value,lighthouse.north$value),-127, 41, col=map.palette,  labels=NA, radius=.8,init.angle=90)\n  par(pardefault)\n\n\n# site-specific correlation tests -----------------------------------------\n\nellwood09.shape.corr<-pcor(c(\"delD\",\"PC.shape\",\"sex.num\"),var(ellwood09));ellwood09.shape.corr\npcor.test(ellwood09.shape.corr,1,length(!is.na(ellwood09$PC.shape))) #NS rho=0.03620059, p=0.8577325, df=25, t=0.1811216\n\nellwood09.size.corr<-pcor(c(\"delD\",\"PC.size\",\"sex.num\"),var(ellwood09));ellwood09.size.corr\npcor.test(ellwood09.size.corr,1,length(!is.na(ellwood09$PC.size))) #NS rho=-0.06574754, p=0.7445596, df= 25, t=-0.3294505\n\nmoran.shape.corr<-pcor(c(\"delD\",\"PC.shape\",\"sex.num\"),var(moran));moran.shape.corr  \npcor.test(moran.shape.corr,1,length(!is.na(moran$PC.shape))) #NS rho=-0.247628, p=0.1952715, df= 27, t=-1.328075\n\nmoran.size.corr<-pcor(c(\"delD\",\"PC.size\",\"sex.num\"),var(moran));moran.size.corr \npcor.test(moran.size.corr,1,length(!is.na(moran$PC.size))) #rho=-0.4251674, p=0.02149318, t=-2.440834, df=27\n\npismo.shape.corr<-pcor(c(\"delD\",\"PC.shape\",\"sex.num\"),var(pismo));pismo.shape.corr \npcor.test(pismo.shape.corr,1,length(!is.na(pismo$PC.shape))) #rho=0.4887976, p=0.007185325, df= 27, t=2.908288\n\npismo.size.corr<-pcor(c(\"delD\",\"PC.size\",\"sex.num\"),var(pismo));pismo.size.corr \npcor.test(pismo.size.corr,1,length(!is.na(pismo$PC.size))) #rho=-0.3761431, p=0.04432208, df= 27, -2.110476\n\nlighthouse.shape.corr<-pcor(c(\"delD\",\"PC.shape\",\"sex.num\"),var(lighthouse));lighthouse.shape.corr\npcor.test(lighthouse.shape.corr,1,length(!is.na(lighthouse$PC.shape))) #NS rho=-0.1068326, p=0.6112608, df=23, t=-0.5153003\n\nlighthouse.size.corr<-pcor(c(\"delD\",\"PC.size\",\"sex.num\"),var(lighthouse));lighthouse.size.corr\npcor.test(lighthouse.size.corr,1,length(!is.na(lighthouse$PC.size))) #rho=-0.650112, p=0.0004351707, df=23, t=-4.103277\n\n# site-specific correlation figure ----------------------------------------\n# this works well exported to PDF 8 x 12, then exported to PNG\n\npar(mar = c(3,2,2,2), oma=c(3,3,2,2), mfrow=c(4,2), cex=.8, xpd=NA)  \n\n  plot(lighthouse$PC.size,lighthouse$delD,xlab=\"\",ylab=expression(paste(delta,\"D\"[m])),col=ifelse(lighthouse$sex==\"M\",\"#67a9cf\",\"#ef8a62\"),ylim=c(-190,-30),xlim=c(-6,4.5),pch=16) #males are black\n  lines(ellipse(lighthouse.size.corr,scale=c(sd(lighthouse$PC.size),sd(lighthouse$delD)),centre=c(mean(lighthouse$PC.size),mean(lighthouse$delD)),level=.95))\n  mtext(\"a. Lighthouse Field\", side=3, line=1, adj=0, font=2,cex=0.8)\n  \n  plot(lighthouse$PC.shape,lighthouse$delD,xlab=\"\",ylab=\"\",col=ifelse(lighthouse$sex==\"M\",\"#67a9cf\",\"#ef8a62\"),ylim=c(-190,-30),xlim=c(-4.5,6),pch=16) #males are blue\n  \n  plot(moran$PC.size,moran$delD,xlab=\"\",ylab=expression(paste(delta,\"D\"[m])),col=ifelse(moran$sex==\"M\",\"#67a9cf\",\"#ef8a62\"),ylim=c(-190,-30),xlim=c(-6,4.5),pch=16) #males are blue\n  lines(ellipse(moran.size.corr,scale=c(sd(moran$PC.size),sd(moran$delD)),centre=c(mean(moran$PC.size),mean(moran$delD)),level=.95))\n  mtext(\"b. Moran Lake\", side=3, line=1, adj=0, font=2,cex=0.8)\n  \n  plot(moran$PC.shape,moran$delD,xlab=\"\",ylab=\"\",col=ifelse(moran$sex==\"M\",\"#67a9cf\",\"#ef8a62\"),ylim=c(-190,-30),xlim=c(-4.5,6),pch=16) #males are blue\n  \n  plot(pismo$PC.size,pismo$delD,xlab=\"\",ylab=expression(paste(delta,\"D\"[m])),col=ifelse(pismo$sex==\"M\",\"#67a9cf\",\"#ef8a62\"),ylim=c(-190,-30),xlim=c(-6,4.5),pch=16) #males are blue\n  lines(ellipse(pismo.size.corr,scale=c(sd(pismo$PC.size),sd(pismo$delD)),centre=c(mean(pismo$PC.size),mean(pismo$delD)),level=.95))\n  mtext(\"c. Pismo Beach\", side=3, line=1, adj=0, font=2,cex=0.8)\n  \n  plot(pismo$PC.shape,pismo$delD,xlab=\"\",ylab=\"\",col=ifelse(pismo$sex==\"M\",\"#67a9cf\",\"#ef8a62\"),ylim=c(-190,-30),xlim=c(-4.5,6),pch=16) #males are blue\n  lines(ellipse(pismo.shape.corr,scale=c(sd(pismo$PC.shape),sd(pismo$delD)),centre=c(mean(pismo$PC.shape),mean(pismo$delD)),level=.95))\n  \n  plot(ellwood09$PC.size,ellwood09$delD,xlab=\"PC-size\",ylab=expression(paste(delta,\"D\"[m])),col=ifelse(ellwood09$sex==\"M\",\"#67a9cf\",\"#ef8a62\"),ylim=c(-190,-30),xlim=c(-6,4.5),pch=16) #males are blue\n  mtext(\"d. Coronado Preserve\", side=3, line=1, adj=0, font=2,cex=0.8)\n  #title(xlab=\"PC-size\",line=0,outer=T, adj=.25)\n  \n  plot(ellwood09$PC.shape,ellwood09$delD,xlab=\"PC-shape\",ylab=\"\",col=ifelse(ellwood09$sex==\"M\",\"#67a9cf\",\"#ef8a62\"),ylim=c(-190,-30),xlim=c(-4.5,6),pch=16) #males are blue\n  #title(xlab=\"PC-shape\",line=0,outer=T, adj=.8)\n\npar(pardefault)\n\n\n# # color analysis ----------------------------------------------------------\n# # no signficant correlations, though the spec readings are correlated with the image analysis \n# \n# plot(d$hue,d$spec.hue)\n# plot(d$sat,d$spec.sat)\n# plot(d$bright,d$spec.bright)\n# \n# plot(d$delD,d$spec.hue)\n# plot(d$delD,d$spec.sat)\n# plot(d$delD,d$spec.bright)\n# \n# cor.test(d$delD,d$spec.hue, use=\"complete\")\n# cor.test(d$delD,d$spec.sat, use=\"complete\")\n# cor.test(d$delD,d$spec.bright, use=\"complete\")\n# \n# aggregate(spec.hue~site,data=d,function(x) c(mean=mean(x),se=std.err(x)))\n# aggregate(spec.sat~site,data=d,function(x) c(mean=mean(x),se=std.err(x)))\n# aggregate(spec.bright~site,data=d,function(x) c(mean=mean(x),se=std.err(x)))\n# \n# aggregate(spec.hue~sex,data=d,function(x) c(mean=mean(x),se=std.err(x)))\n# aggregate(spec.sat~sex,data=d,function(x) c(mean=mean(x),se=std.err(x)))\n# aggregate(spec.bright~sex,data=d,function(x) c(mean=mean(x),se=std.err(x)))\n# \n# color.d<-d[,c(\"delD\",\"site.num\",\"sex.num\",\"spec.hue\",\"spec.sat\",\"spec.bright\")]\n# color.d<-color.d[complete.cases(color.d),]\n# \n# hue.delD.corr<-pcor(c(\"spec.hue\",\"delD\",\"sex.num\",\"site.num\"),var(color.d))\n# pcor.test(hue.delD.corr,2,nrow(color.d))\n# \n# sat.delD.corr<-pcor(c(\"spec.sat\",\"delD\",\"sex.num\",\"site.num\"),var(color.d))\n# pcor.test(sat.delD.corr,2,nrow(color.d))\n# \n# bright.delD.corr<-pcor(c(\"spec.bright\",\"delD\",\"sex.num\",\"site.num\"),var(color.d))\n# pcor.test(bright.delD.corr,2,nrow(color.d))\n\n",
    "created" : 1447971767221.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1539929763",
    "id" : "397C7641",
    "lastKnownWriteTime" : 1444693635,
    "path" : "~/Dropbox/Milkweeds and monarchs/Monarch SIA/monarch SIA 2015-10-12.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}